<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="BUSINESSCOMMUNITY">
	 <select id="queryBcBylabelcn" parameterClass="java.lang.String" resultClass="com.boco.core.ibatis.vo.ResultMap">
		SELECT * FROM BUSINESS_COMMUNITY T WHERE T.LABEL_CN = #LABEL_CN# AND ACCESS_MODE=2
	 </select>
	 <delete id="deleteBusinessCommunity" parameterClass="java.util.HashMap">
	  DELETE FROM  BUSINESS_COMMUNITY  WHERE  1=1 
	 <isNotEmpty property="CUID">
	    AND CUID = #CUID#
	  </isNotEmpty>
	  <isEmpty property="CUID">
	  	AND 1=2
	  </isEmpty>
     </delete>
     <update id="updateBCInfo" parameterClass="java.util.HashMap">
		UPDATE BUSINESS_COMMUNITY 
		  SET LABEL_CN =#LABEL_CN#,
			CITY =	#CITY#,
			ADDRESS =	#ADDRESS#,
			BUILDINGS_NUM =	#BUILDINGS_NUM#,
			UNITS_NUM =	#UNITS_NUM#,
			HOUSEHOLDS_NUM =	#HOUSEHOLDS_NUM#,
			MAINTAIN_PERSON =	#MAINTAIN_PERSON#,
			MAINTAIN_DEPT =	#MAINTAIN_DEPT#,
			WARNING_VALUE =	#WARNING_VALUE#,
			CONTACT_NUMBER =	#CONTACT_NUMBER#,
			CONSTRUCT_DEPT =	#CONSTRUCT_DEPT#,
			IS_PRIORITY =	#IS_PRIORITY#,
			IS_LIGHT_CHANGED =	#IS_LIGHT_CHANGED#,
			IS_OVERLAPP =	#IS_OVERLAPP#,
			BUILD_TYPE	= #BUILD_TYPE#,
			EAST_LONGITUDE = #EAST_LONGITUDE#,
			EAST_LATITUDE  = #EAST_LATITUDE#,
	        WEST_LONGITUDE = #WEST_LONGITUDE#,
			WEST_LATITUDE   = #WEST_LATITUDE#,
			SOUTH_LONGITUDE = #SOUTH_LONGITUDE#,
			SOUTH_LATITUDE  = #SOUTH_LATITUDE#,
			NORTH_LONGITUDE = #NORTH_LONGITUDE#,
			NORTH_LATITUDE  =#NORTH_LATITUDE#
		WHERE CUID = #CUID# AND ACCESS_MODE=2
	  </update>
	  
	   <insert id="insertBCInfo" parameterClass="java.util.HashMap">
		INSERT INTO BUSINESS_COMMUNITY
		(LABEL_CN	,
			CITY	,
			ADDRESS	,
			BUILDINGS_NUM	,
			UNITS_NUM	,
			HOUSEHOLDS_NUM	,
			MAINTAIN_PERSON	,
			MAINTAIN_DEPT	,
			WARNING_VALUE	,
			CONTACT_NUMBER	,
			CONSTRUCT_DEPT	,
			IS_PRIORITY	,
			IS_LIGHT_CHANGED,
			IS_OVERLAPP	,
			BUILD_TYPE,
			ACCESS_MODE,
EAST_LONGITUDE,  
EAST_LATITUDE,  	
WEST_LONGITUDE, 	
WEST_LATITUDE,  	
SOUTH_LONGITUDE,	
SOUTH_LATITUDE, 	
NORTH_LONGITUDE,	
NORTH_LATITUDE,  	
CUID
			) VALUES 
		 (#LABEL_CN#,
			#CITY#,
			#ADDRESS#,
			#BUILDINGS_NUM#,
			#UNITS_NUM#,
			#HOUSEHOLDS_NUM#,
			#MAINTAIN_PERSON#,
			#MAINTAIN_DEPT#,
			#WARNING_VALUE#,
			#CONTACT_NUMBER#,
			#CONSTRUCT_DEPT#,
			#IS_PRIORITY#,
			#IS_LIGHT_CHANGED#,
			#IS_OVERLAPP#,
			#BUILD_TYPE#,
			'2',
#EAST_LONGITUDE#,    
#EAST_LATITUDE#,     
#WEST_LONGITUDE#,    
#WEST_LATITUDE#,     
#SOUTH_LONGITUDE#,   
#SOUTH_LATITUDE#,    
#NORTH_LONGITUDE#,   
#NORTH_LATIT#,        
#CUID#
		)
	</insert>
	 <select id="selectBusinessCommunityByCuid" resultClass="com.boco.core.ibatis.vo.ResultMap" parameterClass="java.lang.String">
			SELECT LABEL_CN,(SELECT LABEL_CN FROM DISTRICT D WHERE D.CUID = BC.CITY ) AS CITY, ADDRESS, BUILDINGS_NUM, UNITS_NUM, HOUSEHOLDS_NUM,
			       MAINTAIN_PERSON, (SELECT LABEL_CN
			                           FROM T_ROFH_MAINTAIN_DEPT MD
			                          WHERE MD.CUID = BC.MAINTAIN_DEPT) AS MAINTAIN_DEPT,
			       WARNING_VALUE, CONTACT_NUMBER,
			       (SELECT LABEL_CN
			          FROM T_ROFH_MAINTAIN_DEPT MD
			         WHERE MD.CUID = BC.CONSTRUCT_DEPT) CONSTRUCT_DEPT,CONSTRUCT_DEPT AS CONSTRUCT_DEPT_CUID, decode(IS_PRIORITY,'1','是','2','否') AS IS_PRIORITY,
			       decode(IS_LIGHT_CHANGED,'1','是','2','否') AS IS_LIGHT_CHANGED, decode(IS_OVERLAPP,'1','是','2','否') AS IS_OVERLAPP,BUILD_TYPE, CUID
			  FROM BUSINESS_COMMUNITY BC WHERE CUID=#cuid# 
	 </select>
	  <select id="selectBusinessCommunityNoTransByCuid" resultClass="com.boco.core.ibatis.vo.ResultMap" parameterClass="java.lang.String">
			SELECT LABEL_CN, CITY, ADDRESS, BUILDINGS_NUM, UNITS_NUM, HOUSEHOLDS_NUM,
			       MAINTAIN_PERSON,  MAINTAIN_DEPT,
			       WARNING_VALUE, CONTACT_NUMBER,
			       CONSTRUCT_DEPT,  IS_PRIORITY,
			       IS_LIGHT_CHANGED,  IS_OVERLAPP, BUILD_TYPE,CUID,
			       EAST_LONGITUDE,
			       EAST_LATITUDE,
			       WEST_LONGITUDE, 
                   WEST_LATITUDE,  
                   SOUTH_LONGITUDE,
                   SOUTH_LATITUDE, 
                   NORTH_LONGITUDE,
                   NORTH_LATITUDE  

			  FROM BUSINESS_COMMUNITY BC WHERE CUID=#cuid#
	 </select>
	 
	 <select id="selectBusinessCommunityByLabeCn" resultClass="com.boco.core.ibatis.vo.ResultMap" parameterClass="java.util.HashMap">
		SELECT CUID,LABEL_CN	,
			CITY	,
			ADDRESS	,
			BUILDINGS_NUM	,
			UNITS_NUM	,
			HOUSEHOLDS_NUM	,
			MAINTAIN_PERSON	,
			MAINTAIN_DEPT	,
			WARNING_VALUE	,
			CONTACT_NUMBER	,
			CONSTRUCT_DEPT	,
			IS_PRIORITY	,
			IS_LIGHT_CHANGED	,
			IS_OVERLAPP	,
			BUILD_TYPE,
			       EAST_LONGITUDE,
		           EAST_LATITUDE,
			       WEST_LONGITUDE, 
                   WEST_LATITUDE,  
                   SOUTH_LONGITUDE,
                   SOUTH_LATITUDE, 
                   NORTH_LONGITUDE,
                   NORTH_LATITUDE  	 
			FROM BUSINESS_COMMUNITY WHERE LABEL_CN=#LABEL_CN# AND CITY =#CITY# AND ACCESS_MODE=2
	 </select>
	 
	 <select id="selectDistrictByLabeCn" resultClass="com.boco.core.ibatis.vo.ResultMap" parameterClass="java.lang.String">
		SELECT CUID,LABEL_CN FROM DISTRICT WHERE LABEL_CN=#labelCn#
	 </select>
	 
	 <select id="selectMaintainDeptByLabeCn" resultClass="com.boco.core.ibatis.vo.ResultMap" parameterClass="java.lang.String">
		 SELECT CUID,LABEL_CN FROM T_ROFH_MAINTAIN_DEPT MD WHERE LABEL_CN=#labelCn#
	 </select>
	
	 <select id="selectBooleanByLabeCn" resultClass="com.boco.core.ibatis.vo.ResultMap" parameterClass="java.lang.String">
		SELECT CUID, LABEL_CN
	  FROM (SELECT '1' AS CUID, '是' AS LABEL_CN
	          FROM DUAL
	        UNION ALL
	        SELECT '2' AS CUID, '否' AS LABEL_CN
	          FROM DUAL)
	 WHERE LABEL_CN =#labelCn#
	 </select>
</sqlMap>